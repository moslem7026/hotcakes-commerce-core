var NO_JQUERY = {}; !function (p, o) { if (!("console" in p)) { var e = p.console = {}; e.log = e.warn = e.error = e.debug = function () { } } o === NO_JQUERY && (o = { fn: {}, extend: function () { for (var e = arguments[0], t = 1, n = arguments.length; t < n; t++) { var s = arguments[t]; for (var a in s) e[a] = s[a] } return e } }), o.fn.pm = function () { return console.log("usage: \nto send:    $.pm(options)\nto receive: $.pm.bind(type, fn, [origin])"), this }, o.pm = p.pm = function (e) { f.send(e) }, o.pm.bind = p.pm.bind = function (e, t, n, s, a) { f.bind(e, t, n, s, !0 === a) }, o.pm.unbind = p.pm.unbind = function (e, t) { f.unbind(e, t) }, o.pm.origin = p.pm.origin = null, o.pm.poll = p.pm.poll = 200; var f = { send: function (e) { var t = o.extend({}, f.defaults, e), n = t.target; if (t.target) if (t.type) { var s = { data: t.data, type: t.type }; t.success && (s.callback = f._callback(t.success)), t.error && (s.errback = f._callback(t.error)), "postMessage" in n && !t.hash ? (f._bind(), n.postMessage(JSON.stringify(s), t.origin || "*")) : (f.hash._bind(), f.hash.send(t, s)) } else console.warn("postmessage type required"); else console.warn("postmessage target window required") }, bind: function (e, t, n, s, a) { f._replyBind(e, t, n, s, a) }, _replyBind: function (e, t, n, s, a) { "postMessage" in p && !s ? f._bind() : f.hash._bind(); var r = f.data("listeners.postmessage"); r || (r = {}, f.data("listeners.postmessage", r)); var i = r[e]; i || (i = [], r[e] = i), i.push({ fn: t, callback: a, origin: n || o.pm.origin }) }, unbind: function (e, t) { var n = f.data("listeners.postmessage"); if (n) if (e) if (t) { var s = n[e]; if (s) { for (var a = [], r = 0, i = s.length; r < i; r++) { var o = s[r]; o.fn !== t && a.push(o) } n[e] = a } } else delete n[e]; else for (var r in n) delete n[r] }, data: function (e, t) { return void 0 === t ? f._data[e] : f._data[e] = t }, _data: {}, _CHARS: "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""), _random: function () { for (var e = [], t = 0; t < 32; t++)e[t] = f._CHARS[0 | 32 * Math.random()]; return e.join("") }, _callback: function (e) { var t = f.data("callbacks.postmessage"); t || (t = {}, f.data("callbacks.postmessage", t)); var n = f._random(); return t[n] = e, n }, _bind: function () { f.data("listening.postmessage") || (p.addEventListener ? p.addEventListener("message", f._dispatch, !1) : p.attachEvent && p.attachEvent("onmessage", f._dispatch), f.data("listening.postmessage", 1)) }, _dispatch: function (t) { try { var n = JSON.parse(t.data) } catch (e) { return void console.warn("postmessage data invalid json: ", e) } if (n.type) { var e = (f.data("callbacks.postmessage") || {})[n.type]; if (e) e(n.data); else for (var s = (f.data("listeners.postmessage") || {})[n.type] || [], a = 0, r = s.length; a < r; a++) { var i = s[a]; if (i.origin && "*" !== i.origin && t.origin !== i.origin) { if (console.warn("postmessage message origin mismatch", t.origin, i.origin), n.errback) { var o = { message: "postmessage origin mismatch", origin: [t.origin, i.origin] }; f.send({ target: t.source, data: o, type: n.errback }) } } else try { i.callback ? i.fn(n.data, l, t) : l(i.fn(n.data, t)) } catch (e) { if (!n.errback) throw e; f.send({ target: t.source, data: e, type: n.errback }) } function l(e) { n.callback && f.send({ target: t.source, data: e, type: n.callback }) } } } else console.warn("postmessage message type required") } }; f.hash = { send: function (e, t) { var n = e.target, s = e.url; if (s) { s = f.hash._url(s); var a, r = f.hash._url(p.location.href); if (p == n.parent) a = "parent"; else try { for (var i = 0, o = parent.frames.length; i < o; i++) { if (parent.frames[i] == p) { a = i; break } } } catch (e) { a = p.name } if (null != a) { var l = { "x-requested-with": "postmessage", source: { name: a, url: r }, postmessage: t }, c = "#x-postmessage-id=" + f._random(); n.location = s + c + encodeURIComponent(JSON.stringify(l)) } else console.warn("postmessage windows must be direct parent/child windows and the child must be available through the parent window.frames list") } else console.warn("postmessage target window url is required") }, _regex: /^\#x\-postmessage\-id\=(\w{32})/, _regex_len: "#x-postmessage-id=".length + 32, _bind: function () { f.data("polling.postmessage") || (setInterval(function () { var e = "" + p.location.hash, t = f.hash._regex.exec(e); if (t) { var n = t[1]; f.hash._last !== n && (f.hash._last = n, f.hash._dispatch(e.substring(f.hash._regex_len))) } }, o.pm.poll || 200), f.data("polling.postmessage", 1)) }, _dispatch: function (t) { if (t) { try { if (!("postmessage" === (t = JSON.parse(decodeURIComponent(t)))["x-requested-with"] && t.source && null != t.source.name && t.source.url && t.postmessage)) return } catch (e) { return } var n = t.postmessage, e = (f.data("callbacks.postmessage") || {})[n.type]; if (e) e(n.data); else { var s; s = "parent" === t.source.name ? p.parent : p.frames[t.source.name]; for (var a = (f.data("listeners.postmessage") || {})[n.type] || [], r = 0, i = a.length; r < i; r++) { var o = a[r]; if (o.origin) { var l = /https?\:\/\/[^\/]*/.exec(t.source.url)[0]; if ("*" !== o.origin && l !== o.origin) { if (console.warn("postmessage message origin mismatch", l, o.origin), n.errback) { var c = { message: "postmessage origin mismatch", origin: [l, o.origin] }; f.send({ target: s, data: c, type: n.errback, hash: !0, url: t.source.url }) } continue } } function u(e) { n.callback && f.send({ target: s, data: e, type: n.callback, hash: !0, url: t.source.url }) } try { o.callback ? o.fn(n.data, u) : u(o.fn(n.data)) } catch (e) { if (!n.errback) throw e; f.send({ target: s, data: e, type: n.errback, hash: !0, url: t.source.url }) } } } } }, _url: function (e) { return ("" + e).replace(/#.*$/, "") } }, o.extend(f, { defaults: { target: null, url: null, type: null, data: null, success: null, error: null, origin: "*", hash: !1 } }) }(this, "undefined" == typeof jQuery ? NO_JQUERY : jQuery), "JSON" in window && window.JSON || (JSON = {}), function () { function f(e) { return e < 10 ? "0" + e : e } "function" != typeof Date.prototype.toJSON && (Date.prototype.toJSON = function (e) { return this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z" }, String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function (e) { return this.valueOf() }); var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, gap, indent, meta = { "\b": "\\b", "\t": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\" }, rep; function quote(e) { return escapable.lastIndex = 0, escapable.test(e) ? '"' + e.replace(escapable, function (e) { var t = meta[e]; return "string" == typeof t ? t : "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4) }) + '"' : '"' + e + '"' } function str(e, t) { var n, s, a, r, i, o = gap, l = t[e]; switch (l && "object" == typeof l && "function" == typeof l.toJSON && (l = l.toJSON(e)), "function" == typeof rep && (l = rep.call(t, e, l)), typeof l) { case "string": return quote(l); case "number": return isFinite(l) ? String(l) : "null"; case "boolean": case "null": return String(l); case "object": if (!l) return "null"; if (gap += indent, i = [], "[object Array]" === Object.prototype.toString.apply(l)) { for (r = l.length, n = 0; n < r; n += 1)i[n] = str(n, l) || "null"; return a = 0 === i.length ? "[]" : gap ? "[\n" + gap + i.join(",\n" + gap) + "\n" + o + "]" : "[" + i.join(",") + "]", gap = o, a } if (rep && "object" == typeof rep) for (r = rep.length, n = 0; n < r; n += 1)"string" == typeof (s = rep[n]) && (a = str(s, l)) && i.push(quote(s) + (gap ? ": " : ":") + a); else for (s in l) Object.hasOwnProperty.call(l, s) && (a = str(s, l)) && i.push(quote(s) + (gap ? ": " : ":") + a); return a = 0 === i.length ? "{}" : gap ? "{\n" + gap + i.join(",\n" + gap) + "\n" + o + "}" : "{" + i.join(",") + "}", gap = o, a } } "function" != typeof JSON.stringify && (JSON.stringify = function (e, t, n) { var s; if (indent = gap = "", "number" == typeof n) for (s = 0; s < n; s += 1)indent += " "; else "string" == typeof n && (indent = n); if ((rep = t) && "function" != typeof t && ("object" != typeof t || "number" != typeof t.length)) throw new Error("JSON.stringify"); return str("", { "": e }) }), "function" != typeof JSON.parse && (JSON.parse = function (text, reviver) { var j; function walk(e, t) { var n, s, a = e[t]; if (a && "object" == typeof a) for (n in a) Object.hasOwnProperty.call(a, n) && (void 0 !== (s = walk(a, n)) ? a[n] = s : delete a[n]); return reviver.call(e, t, a) } if (cx.lastIndex = 0, cx.test(text) && (text = text.replace(cx, function (e) { return "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4) })), /^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) return j = eval("(" + text + ")"), "function" == typeof reviver ? walk({ "": j }, "") : j; throw new SyntaxError("JSON.parse") }) }(), function (a, r) { "use strict"; a.SeamlessBase = { isNumeric: function (e) { return 0 <= e - parseFloat(e) + 1 }, getElement: function (e) { var t = "querySelectorAll"; 0 === e.indexOf("#") && (t = "getElementById", e = e.substr(1, e.length)); var n = r[t](e); return n && "querySelectorAll" === t ? n[0] : n }, elementHeight: function (e) { var t = 0, n = 0; n = r.all ? (t = e.currentStyle.height, this.isNumeric(t) || (t = e.offsetHeight), t = parseInt(t, 10), parseInt(e.currentStyle.marginTop, 10) + parseInt(e.currentStyle.marginBottom, 10)) : (t = parseInt(r.defaultView.getComputedStyle(e, "").getPropertyValue("height"), 10), parseInt(r.defaultView.getComputedStyle(e, "").getPropertyValue("margin-top"), 10) + parseInt(r.defaultView.getComputedStyle(e, "").getPropertyValue("margin-bottom"), 10)); var s = t + n; return e.scrollHeight > s ? e.scrollHeight : s }, hasClass: function (e, t) { return e.classList ? e.classList.contains(t) : !!e.className.match(new RegExp("(\\s|^)" + t + "(\\s|$)")) }, addClass: function (e, t) { e.classList ? e.classList.add(t) : this.hasClass(e, t) || (e.className += " " + t) }, removeClass: function (e, t) { if (e.classList) e.classList.remove(t); else if (this.hasClass(e, t)) { var n = new RegExp("(\\s|^)" + t + "(\\s|$)"); e.className = e.className.replace(n, " ") } }, getParam: function (e, t) { t = t || a.location.search; var n = new RegExp("[?&]" + e + "=([^&#]*)").exec(t); return null === n ? "" : decodeURIComponent(n[1].replace(/\+/g, " ")) }, filterText: function (e) { return e.replace(/[<>]/g, "") }, isEmptyObject: function (e) { var t; for (t in e) return !1; return !0 }, setStyle: function (e, t) { 0 < t.length && (t = "string" == typeof t ? t : t.join(" "), t = a.SeamlessBase.filterText(t), e.styleSheet ? e.styleSheet.cssText = t : e.innerHTML = t) }, injectStyles: function (e) { var t = this.getElement("style#injected-styles"); if (t) a.SeamlessBase.setStyle(t, e); else { var n = r.createElement("style"); n.setAttribute("type", "text/css"), n.setAttribute("id", "injected-styles"), a.SeamlessBase.setStyle(n, e); var s = r.head || r.getElementsByTagName("head")[0]; s && s.appendChild(n) } }, injectAppendedStyles: function (e) { var t = e.join(";"), n = r.head || r.getElementsByTagName("head")[0], s = r.createElement("style"); s.type = "text/css", s.styleSheet ? s.styleSheet.cssText = t : s.appendChild(r.createTextNode(t)), n.appendChild(s) } } }(window, document), function (t) { "use strict"; t.SeamlessConnection = function (e, t) { this.id = 0, this.target = e, this.url = t, this.active = !1, this.queue = [] }, t.SeamlessConnection.prototype.send = function (e) { this.active && this.target ? ((e = e || {}).hasOwnProperty("data") || (e = { data: e }), e.target = this.target, e.url = this.url || "index.html", e.type = e.type || "seamless_data", e.data = e.data || {}, e.data.__id = this.id, t.pm(e)) : this.queue.push(e) }, t.SeamlessConnection.prototype.receive = function (e, n) { "function" == typeof e && (n = e, e = "seamless_data"); var s = this; t.pm.bind(e, function (e, t) { return !(!e.__id || e.__id !== s.id) && n(e, t) }) }, t.SeamlessConnection.prototype.setActive = function (e) { if (this.active = e, 0 < this.queue.length) { for (var t in this.queue) this.send(this.queue[t]); this.queue = [], this.queue.length = 0 } } }(window), function (g, h, e) { "use strict"; g.hasOwnProperty("pm") ? e.seamless = g.seamless = { options: { url: "", container: "body", update: 200, allowStyleInjection: !1, allowAppendedStyleInjection: !1, requireCookies: !1, cookieFallbackMsg: "Your browser requires this page to be opened in a separate window.", cookieFallbackLinkMsg: "Click Here", cookieFallbackAfterMsg: " to open in a separate window.", onUpdate: null, onConnect: null }, connect: function (s) { for (var e in s = s || {}) this.options.hasOwnProperty(e) && (this.options[e] = s[e]); s = this.options; var t, n, a, r = new g.SeamlessConnection(g.parent, s.url), i = !1; r.setActive(!0), s.requireCookies && (h.cookie = "cookieTest=1", -1 === h.cookie.indexOf("cookieTest") && (t = s.cookieFallbackMsg, n = s.cookieFallbackLinkMsg, a = s.cookieFallbackAfterMsg, i = !0, r.send({ type: "seamless_error", data: { msg: t, linkText: n, afterText: a } }))); var o = g.SeamlessBase.getParam("noiframe").toString(); if ("1" === o || "true" === o.toLowerCase()) r.send({ type: "seamless_noiframe", data: { href: g.location.href } }); else { var l = !1, c = s.container, u = 0, p = 0, f = function () { if (!i) { p && clearTimeout(p); var e = g.SeamlessBase.elementHeight(g.SeamlessBase.getElement(c)); if (!l && u !== e) { l = !0; var t = { height: e }; s.onUpdate && s.onUpdate(t), r.send({ type: "seamless_update", data: t, success: function (e) { u = e.height, l = !1 } }) } p = setTimeout(f, s.update) } }, d = function (e) { i || (e = e || 0, r.id || (r.send({ type: "seamless_ready", data: {} }), e < 50 && setTimeout(function () { d(++e) }, 200))) }; g.pm.bind("seamless_styles", function (e) { s.allowStyleInjection && g.SeamlessBase.injectStyles(e), s.allowAppendedStyleInjection && g.SeamlessBase.injectAppendedStyles(e), f() }), g.pm.bind("seamless_connect", function (e, t) { r.id = e.id, s.onConnect && s.onConnect(e); var n = h.body.getAttribute("style"); return h.body.setAttribute("style", "overflow:hidden;" + n), h.body.setAttribute("scroll", "no"), s.allowStyleInjection && g.SeamlessBase.injectStyles(e.styles), f(), e }), d() } return r } } : console.log("You must install the postmessage.js module to use seamless.js.") }(window, document, "undefined" == typeof jQuery ? {} : jQuery);