!function(x){"use strict";var e=x.module("colorpicker",[]).factory("ColorHelper",function(){return{hsla2hsva:function(e){var t=Math.min(e.h,1),o=Math.min(e.s,1),a=Math.min(e.l,1),r=Math.min(e.a,1);if(0===a)return{h:t,s:0,v:0,a:r};var n=a+o*(1-Math.abs(2*a-1))/2;return{h:t,s:2*(n-a)/n,v:n,a:r}},hsva2hsla:function(e){var t=e.h,o=e.s,a=e.v,r=e.a;if(0===a)return{h:t,s:0,l:0,a:r};if(0===o&&1===a)return{h:t,s:1,l:1,a:r};var n=a*(2-o)/2;return{h:t,s:a*o/(1-Math.abs(2*n-1)),l:n,a:r}},rgbaToHsva:function(e){var t,o,a=Math.min(e.r,1),r=Math.min(e.g,1),n=Math.min(e.b,1),s=Math.min(e.a,1),i=Math.max(a,r,n),l=Math.min(a,r,n),c=i,u=i-l;if(o=0===i?0:u/i,i===l)t=0;else{switch(i){case a:t=(r-n)/u+(r<n?6:0);break;case r:t=(n-a)/u+2;break;case n:t=(a-r)/u+4}t/=6}return{h:t,s:o,v:c,a:s}},hsvaToRgba:function(e){var t,o,a,r=e.h,n=e.s,s=e.v,i=e.a,l=Math.floor(6*r),c=6*r-l,u=s*(1-n),h=s*(1-c*n),p=s*(1-(1-c)*n);switch(l%6){case 0:t=s,o=p,a=u;break;case 1:t=h,o=s,a=u;break;case 2:t=u,o=s,a=p;break;case 3:t=u,o=h,a=s;break;case 4:t=p,o=u,a=s;break;case 5:t=s,o=u,a=h}return{r:t,g:o,b:a,a:i}},stringToHsva:function(e){var t=[{re:/(rgb)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*%?,\s*(\d{1,3})\s*%?(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return["rgb",parseInt(e[2]),parseInt(e[3]),parseInt(e[4]),isNaN(parseFloat(e[5]))?1:parseFloat(e[5])]}},{re:/(hsl)a?\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return["hsl",parseInt(e[2]),parseInt(e[3]),parseInt(e[4]),isNaN(parseFloat(e[5]))?1:parseFloat(e[5])]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,parse:function(e){return["hex",parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),1]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,parse:function(e){return["hex",parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),1]}}];e=e.toLowerCase();var o=null;for(var a in t)if(t.hasOwnProperty(a)){var r=t[a],n=r.re.exec(e),s=n&&r.parse(n);if(s)return o="hex"===s[0]||"rgb"===s[0]?this.rgbaToHsva({r:s[1]/255,g:s[2]/255,b:s[3]/255,a:s[4]}):this.hsla2hsva({h:s[1]/360,s:s[2]/100,l:s[3]/100,a:s[4]})}return o}}});e.directive("colorpicker",["$document","$compile","ColorHelper",function(f,v,g){return{restrict:"A",scope:{colorPickerModel:"@",colorPickerOutputFormat:"="},controller:["$scope",function(r){function a(e){return{r:Math.round(255*e.r),g:Math.round(255*e.g),b:Math.round(255*e.b),a:e.a}}r.show=!1,r.sAndLMax={},r.hueMax={},r.alphaMax={},r.type=0,r.hsva={h:.5,s:1,v:1,a:1},r.hueSlider={left:0},r.sAndLSlider={left:0,top:0},r.alphaSlider={left:0},r.rbgaSteps={r:1,g:1,b:1,a:.1},r.hslaSteps={h:1,s:1,l:1,a:.1},r.cancelButtonClass="",r.showCancelButton=!1,r.extraLargeClass="","rgba"===r.colorPickerOutputFormat?r.type=1:"hsla"===r.colorPickerOutputFormat&&(r.type=2),r.setSaturation=function(e,t){var o=g.hsva2hsla(r.hsva);o.s=e/t,r.hsva=g.hsla2hsva(o)},r.setLightness=function(e,t){var o=g.hsva2hsla(r.hsva);o.l=e/t,r.hsva=g.hsla2hsva(o)},r.setHue=function(e,t){r.hsva.h=e/t},r.setAlpha=function(e,t){r.hsva.a=e/t},r.setR=function(e,t){var o=g.hsvaToRgba(r.hsva);o.r=e/t,r.hsva=g.rgbaToHsva(o)},r.setG=function(e,t){var o=g.hsvaToRgba(r.hsva);o.g=e/t,r.hsva=g.rgbaToHsva(o)},r.setB=function(e,t){var o=g.hsvaToRgba(r.hsva);o.b=e/t,r.hsva=g.rgbaToHsva(o)},r.setSaturationAndBrightness=function(e,t,o,a){r.hsva.s=e/o,r.hsva.v=t/a},r.update=function(){var e=g.hsva2hsla(r.hsva);r.hslaText={h:Math.round(360*e.h),s:Math.round(100*e.s),l:Math.round(100*e.l),a:Math.round(100*e.a)/100};var t=a(g.hsvaToRgba(r.hsva)),o=a(g.hsvaToRgba({h:r.hsva.h,s:1,v:1,a:1}));if(r.rgbaText={r:t.r,g:t.g,b:t.b,a:Math.round(100*t.a)/100},r.hexText="#"+(1<<24|parseInt(t.r,10)<<16|parseInt(t.g,10)<<8|parseInt(t.b,10)).toString(16).substr(1),r.hexText[1]===r.hexText[2]&&r.hexText[3]===r.hexText[4]&&r.hexText[5]===r.hexText[6]&&(r.hexText="#"+r.hexText[1]+r.hexText[3]+r.hexText[5]),r.alphaSliderColor="rgb("+t.r+","+t.g+","+t.b+")",r.hueSliderColor="rgb("+o.r+","+o.g+","+o.b+")",0===r.type&&r.hsva.a<1&&r.type++,r.hsva.a<1)switch(r.colorPickerOutputFormat){case"hsla":r.outputColor="hsla("+r.hslaText.h+","+r.hslaText.s+"%,"+r.hslaText.l+"%,"+r.hslaText.a+")";break;default:r.outputColor="rgba("+t.r+","+t.g+","+t.b+","+Math.round(100*t.a)/100+")"}else switch(r.colorPickerOutputFormat){case"hsla":r.outputColor="hsl("+r.hslaText.h+","+r.hslaText.s+"%,"+r.hslaText.l+"%)";break;case"rgba":r.outputColor=r.alphaSliderColor;break;default:r.outputColor=r.hexText}r.sAndLSlider={left:r.hsva.s*r.sAndLMax.x-8+"px",top:(1-r.hsva.v)*r.sAndLMax.y-8+"px"},r.hueSlider.left=r.hsva.h*r.hueMax.x+"px",r.alphaSlider.left=r.hsva.a*r.alphaMax.x-8+"px",r.alphaInvalidClass=""},r.setColorFromHex=function(e){var t=g.stringToHsva(e);return null!==t&&(r.hsva=t),t},r.typePolicy=function(){return r.type=(r.type+1)%3,0===r.type&&r.hsva.a<1&&r.type++,r.type}}],link:function(o,t,a){var r,n="";if(t.inputmask("\\#######"),void 0===o.colorPickerModel&&(o.colorPickerModel="#008fff",t.val("")),void 0===a.colorPickerShowValue&&(a.colorPickerShowValue="true"),void 0===a.colorPickerPosition&&(a.colorPickerPosition="right"),void 0===a.colorPickerShowInputSpinner&&(a.colorPickerShowInputSpinner="false"),void 0===a.colorPickerShowCancelButton&&(a.colorPickerShowCancelButton="false"),"true"===a.colorPickerShowCancelButton&&(o.showCancelButton=!0,o.extraLargeClass="color-picker-extra-large"),void 0!==a.colorPickerCancelButtonClass&&(o.cancelButtonClass=a.colorPickerCancelButtonClass),void 0!==a.colorPickerSpinnerRgbaSteps&&null!==a.colorPickerSpinnerRgbaSteps.match(/^\d+;\d+;\d+;[0-9]+([\.][0-9]{1,2})?$/)){var e=a.colorPickerSpinnerRgbaSteps.split(";");o.rbgaSteps={r:e[0],g:e[1],b:e[2],a:e[3]}}if(void 0!==a.colorPickerSpinnerHslaSteps&&null!==a.colorPickerSpinnerHslaSteps.match(/^\d+;\d+;\d+;[0-9]+([\.][0-9]{1,2})?$/)){e=a.colorPickerSpinnerHslaSteps.split(";");o.hslaSteps={h:e[0],s:e[1],l:e[2],a:e[3]}}function s(e){var t=g.stringToHsva(e);null!==t&&(o.hsva=t,o.update())}function i(){setTimeout(function(){l()},5)}function l(){o.$apply(function(){a.colorPickerShowValue="true",s(t.val()),o.colorPickerModel=t.val()})}function c(e){n=o.colorPickerModel,o.$apply(function(){o.show=!0}),o.$apply(function(){o.sAndLMax={x:r[0].getElementsByClassName("saturation-lightness")[0].offsetWidth,y:r[0].getElementsByClassName("saturation-lightness")[0].offsetHeight},o.hueMax={x:r[0].getElementsByClassName("hue")[0].offsetWidth},o.alphaMax={x:r[0].getElementsByClassName("alpha")[0].offsetWidth},o.update()}),h(),f.on("mousedown touchstart",p),x.element(window).on("resize",u)}function u(){h()}function h(){var e;switch("true"===a.colorPickerFixedPosition?(e=d(t[0],!1),r[0].style.position="fixed"):e=d(t[0],!0),a.colorPickerPosition){case"left":r[0].style.top=e.top+"px",r[0].style.left=e.left-252+"px";break;case"top":r[0].style.top=e.top-e.height-284+"px",r[0].style.left=e.left+"px";break;case"bottom":r[0].style.top=e.top+e.height+10+"px",r[0].style.left=e.left+"px";break;default:r[0].style.top=e.top+"px",r[0].style.left=e.left+e.width+"px"}}function p(e){e.target===t[0]||r[0]===e.target||function(e,t){var o=t.parentNode;for(;null!==o;){if(o===e)return!0;o=o.parentNode}return!1}(r[0],e.target)||(o.$apply(function(){o.show=!1}),f.off("mousedown touchstart",p),x.element(window).off("resize",u))}function d(e,t){return{top:e.getBoundingClientRect().top+(t?window.pageYOffset:0),left:e.getBoundingClientRect().left+(t?window.pageXOffset:0),width:e.offsetWidth,height:e.offsetHeight}}s(o.colorPickerModel),"true"===a.colorPickerShowValue&&t.val(o.outputColor),r=x.element('<div ng-show="show" class="color-picker {{extraLargeClass}}" style="touch-action: none;">   <div class="arrow arrow-'+a.colorPickerPosition+'"></div>   <div colorpickerslider rg-x=1 rg-y=1 action="setSaturationAndBrightness(s, v, rgX, rgY)" class="saturation-lightness" ng-style="{\'background-color\':hueSliderColor}">       <div class="cursor-sv" ng-style="{\'top\':sAndLSlider.top, \'left\':sAndLSlider.left}"></div>   </div>   <div colorpickerslider rg-x=1 action="setHue(v, rg)" class="hue">       <div class="cursor" ng-style="{\'left\':hueSlider.left}"></div>   </div>   <div class="hex-text alpha" ng-show="type==0">       <input text type="text" action="setColorFromHex(string)" ng-model="hexText"/>   </div>   <div class="selected-color-background"></div>   <div class="selected-color" ng-style="{\'background-color\':outputColor}"></div>   <div ng-show="type==2" class="hsla-text">       <input text type="number" pattern="[0-9]*" min="0" max="360" step="'+o.hslaSteps.h+'" rg=360 action="setHue(v, rg)" ng-model="hslaText.h" spinner="'+a.colorPickerShowInputSpinner+'" />       <input text type="number" pattern="[0-9]*" min="0" max="100" step="'+o.hslaSteps.s+'" rg=100 action="setSaturation(v, rg)" ng-model="hslaText.s" spinner="'+a.colorPickerShowInputSpinner+'" />       <input text type="number" pattern="[0-9]*" min="0" max="100" step="'+o.hslaSteps.l+'" rg=100 action="setLightness(v, rg)" ng-model="hslaText.l" spinner="'+a.colorPickerShowInputSpinner+'" />       <input text type="number" pattern="[0-9]+([.,][0-9]{1,2})?" min="0" max="1" step="'+o.hslaSteps.a+'" rg=1 action="setAlpha(v, rg)" ng-model="hslaText.a" spinner="'+a.colorPickerShowInputSpinner+'" />       <div>H</div><div>S</div><div>L</div><div>A</div>   </div>   <div ng-show="type==1" class="rgba-text">       <input text type="number" pattern="[0-9]*" min="0" max="255" step="'+o.rbgaSteps.r+'" rg=255 action="setR(v, rg)" ng-model="rgbaText.r" spinner="'+a.colorPickerShowInputSpinner+'" />       <input text type="number" pattern="[0-9]*" min="0" max="255" step="'+o.rbgaSteps.g+'" rg=255 action="setG(v, rg)" ng-model="rgbaText.g" spinner="'+a.colorPickerShowInputSpinner+'" />       <input text type="number" pattern="[0-9]*" min="0" max="255" step="'+o.rbgaSteps.b+'" rg=255 action="setB(v, rg)" ng-model="rgbaText.b" spinner="'+a.colorPickerShowInputSpinner+'" />       <input text type="number" pattern="[0-9]+([.,][0-9]{1,2})?" min="0" max="1" step="'+o.rbgaSteps.a+'" rg=1 action="setAlpha(v, rg)" ng-model="rgbaText.a" spinner="'+a.colorPickerShowInputSpinner+'" />       <div>R</div><div>G</div><div>B</div><div>A</div>   </div>   <button type="button" class="{{cancelButtonClass}}" ng-show="showCancelButton" ng-click="cancelColor()">Cancel</button></div>'),document.getElementsByTagName("body")[0].appendChild(r[0]),v(r)(o),t.on("paste",i),t.on("keyup",l),o.$on("color-changed",function(e){o.$apply(function(){o.update(),o.colorPickerModel=o.outputColor,"true"===a.colorPickerShowValue&&t.val(o.outputColor)})}),o.cancelColor=function(){o.colorPickerModel=n,o.show=!1,s(o.colorPickerModel),f.off("mousedown touchstart",p),x.element(window).off("resize",u)},t.on("click",c),t.on("$destroy",function(){t.off("click",c),t.off("keyup",l),t.off("paste",i),r.remove()})}}}]),e.directive("text",[function(){return{restrict:"A",scope:{action:"&"},link:function(o,a,r){function e(e){"true"===r.spinner&&a.removeClass("color-picker-input-spinner")}function t(e){a.addClass("color-picker-input-spinner")}function n(e){setTimeout(function(){s(e)},5)}function s(e){if(void 0===r.rg)o.action({string:a.val()})&&o.$emit("color-changed");else{var t=parseFloat(a.val());isNaN(t)?o.$emit("alpha-invalid"):(t=Math.abs(Math.min(parseFloat(a.val()),r.rg)),o.action({v:t,rg:r.rg}),o.$emit("color-changed"),o.$emit("alpha-valid"))}}a.on("paste",n),a.on("keyup",s),a.on("change",s),a.on("focus",e),a.on("blur",t),a.on("mouseover",e),a.on("mouseout",t),a.addClass("color-picker-input-spinner"),a.on("$destroy",function(){a.off("paste",n),a.off("keyup",s),a.off("change",s),a.off("focus",e),a.off("blur",t),a.off("mouseover",e),a.off("mouseout",t)})}}}]),e.directive("colorpickerslider",["$document","$window",function(a,l){return{restrict:"A",scope:{action:"&"},link:function(n,s,i){function e(e){o(e),a.on("mousemove touchmove",t)}function t(e){e.preventDefault(),o(e)}function o(e){var t=s[0].offsetHeight,o=s[0].offsetWidth,a=Math.max(0,Math.min(function(e,t){return(void 0!==e.pageX?e.pageX:e.touches[0].pageX)-t.getBoundingClientRect().left-l.pageXOffset}(e,s[0]),o)),r=Math.max(0,Math.min(function(e,t){return(void 0!==e.pageY?e.pageY:e.touches[0].pageY)-t.getBoundingClientRect().top-l.pageYOffset}(e,s[0]),t));void 0!==i.rgX&&void 0!==i.rgY?n.action({s:a/o,v:1-r/t,rgX:i.rgX,rgY:i.rgY}):n.action({v:a/o,rg:i.rgX}),n.$emit("color-changed")}s.on("mousedown touchstart",e),a.on("mouseup touchend",function(){a.off("mousemove touchmove",t)}),s.on("$destroy",function(){s.off("mousedown touchend",e)})}}}])}(dnnsfAngular15||angular);